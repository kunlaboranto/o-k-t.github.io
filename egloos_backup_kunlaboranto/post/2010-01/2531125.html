<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="../../css/result.css">

        <title>[펌] [sybase] Update 시 조인을 걸어서 사용하기.</title>
    </head>
    <body>
        <section id="wrap">
            <header>
                <h1 class="logo-title">
                    <span class="main"><img src="../../images/logo_egloos.png" width="105" height="34" alt="이글루스"></span>
                </h1>
                <div class="user-info">
                    <strong class="name">kun</strong> 님 (<strong class="name">okseop7</strong>)
                </div>
            </header>
            <main>
                <article class="post-wrap">
                    <!-- 게시물 정보 : 날짜 -->
                    <div class="post-info">
                        <span class="time">2010-01-29 16:13:53</span>
                    </div>
                    <!-- 게시물 제목 -->
                    <h2 class="post-title">[펌] [sybase] Update 시 조인을 걸어서 사용하기.</h2>
                    <!-- 게시물 본문 -->
                    <div class="post-body">
                        <div class="content"><br><br><div class="entry-content"><p>[출처] <a href="http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.dc38151_1270/html/iqref/Update.htm">http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.dc38151_1270/html/iqref/Update.htm</a></p>example 3 의 진하게 표시해둔 부분이다.<br><br>---------------------------------------------------------------------------<br><br><p><em>Chapter 6: SQL Statements</em> </p><hr noshade="noshade" size="1"><h1 class="refname">UPDATE statement</h1><h3 class="refhead">Description</h3><p>Modifies existing rows of a single table, or a view that contains only one table.</p><h3 class="refhead">Syntax</h3><pre><b>UPDATE</b> <i>table<br></i>...  <b>SET</b> [<i>column-name</i>  = <i>expression</i>, ...<br>...  [ <b>FROM</b> <i>table-expression</i>, ]<br>...  [ <b>WHERE</b> <i>search-condition</i> ]<br>...  [ <b>ORDER</b> <b>BY</b> <i>expression</i> [ <b>ASC</b> | <b>DESC</b> ] ,... ]<br></pre><pre><b>FROM</b><i> table-expression</i><br><i>table-expression:</i><br><i>table-spec</i> | <i>table-expression join-type table-spec</i> [ <b>ON</b> <i>condition</i> ] | <i>table-expression</i>, ...<br></pre><h3 class="refhead">Examples</h3><h4 class="refname"><i>Example 1</i></h4><ul><li class="fi"><p>Transfers employee Philip Chin (employee 129) from the sales department to the marketing department:</p></li></ul><pre>UPDATE employee<br>SET dept_id = 400<br>WHERE emp_id = 129 ;<br></pre><h4 class="refname"><i>Example 2</i></h4><ul><li class="fi"><p>The Marketing Department (400) increases bonuses from 4% to 6% of each employee’s base salary:</p></li></ul><pre>UPDATE employee<br>SET bonus = base * 6/100<br>WHERE dept_id=400;<br></pre><h4 class="refname"><i>Example 3</i></h4><ul><li class="fi"><p>Each employee gets a pay increase with the department bonus: </p></li></ul><pre>UPDATE employee<br>SET emp.salary = emp.salary + dept.bonus<br><font style="background-color: rgb(250, 255, 169);" color="#ff0000" size="5"><strong>FROM employee emp, department dept<br>WHERE emp.deptnum = dept.deptnum;</strong></font><br></pre><h4 class="refname"><i>Example 4</i></h4><ul><li class="fi"><p>Another way to give each employee a pay increase with the department bonus:</p></li></ul><pre>UPDATE employee<br>SET emp.salary = emp.salary + dept.bonus<br>FROM employee emp JOIN department dept<br>ON emp.deptnum = dept.deptnum;<br></pre><h3 class="refhead">Usage</h3><p>The table on which you use <b>UPDATE</b> may be a base table or a temporary table. </p><div class="note"><p><img alt="Note" src="http://infocenter.sybase.com/help/topic/com.sybase.dc38151_1270/html/iqref/note.gif" width="17" align="bottom" border="0" height="17">The base table cannot be part of any join index. </p></div><p>Each named column is set to the value of the expression on the right-hand side of the equal sign. Even <i>column-name</i> can be used in the expression—the old value is used. </p><p>The <b>FROM</b> clause can contain multiple tables with join conditions and returns all the columns from all the tables specified and filtered by the join condition and/or <b>WHERE</b> condition.</p><p>Using the wrong join condition in a <b>FROM</b> clause causes unpredictable results. If the <b>FROM</b> clause specifies a one-to-many join and the <b>SET</b> clause references a cell from the “many” side of the join, the cell is updated from the first value selected. In other words, if the join condition causes multiple rows of the table to be updated per row ID, the first row returned becomes the update result. For example:</p><pre>UPDATE T1 <br>SET T1.c2 = T2.c2<br>FROM T1 JOIN TO T2<br>ON T1.c1 = T2.c1<br></pre><p>If table <i>T2</i> has more than one row per <i>T2.c1</i>, results might be as follows:</p><pre>T2.c1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;T2.c2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;T2.c3<br></pre><pre>1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3<br></pre><pre>1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1<br></pre><pre>1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4<br></pre><pre>1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2<br></pre><p>With no <b>ORDER BY</b> clause, <i>T1.c2</i> may be 4, 6, 8, or 9. </p><ul><li class="fi"><p>With <code>ORDER BY T2.c3</code>, <i>T1.c2</i> is updated to 8. </p></li><li class="ds"><p>With <code>ORDER BY T2.c3 DESC</code>, <i>T1.c2</i> is updated to 6.</p></li></ul><p>Sybase IQ rejects any <b>UPDATE</b> statement in which the table being updated is on the null-supplying side of an outer join. In other words:</p><ul><li class="fi"><p>In a left outer join, the table on the left side of the join cannot be missing any rows on joined columns.</p></li><li class="ds"><p>In a right outer join, the table on the right side of the join cannot be missing any rows on joined columns.</p></li><li class="ds"><p>In a full outer join, neither table can be missing any rows on joined columns.</p></li></ul><p>For example, in the following statement, table <i>T1</i> is on the left side of a left outer join, and thus cannot contain be missing any rows:</p><pre>UPDATE T1 <br>SET T1.c2 = T2.c4<br>FROM T1 LEFT OUTER JOIN T2<br>ON T1.rowid = T2.rowid<br></pre><p>Normally, the order in which rows are updated does not matter. However, in conjunction with the <b>NUMBER(*)</b> function, an ordering can be useful to get increasing numbers added to the rows in some specified order. If you are not using the <b>NUMBER(*)</b> function, avoid using the <b>ORDER BY</b> clause, because the <b>UPDATE</b> statement performs better without it.</p><p>In an <b>UPDATE</b> statement, if the <b>NUMBER(*)</b> function is used in the <b>SET</b> clause and the <b>FROM</b> clause specifies a one-to-many join, <b>NUMBER(*)</b> generates unique numbers that increase, but do not increment sequentially due to row elimination. For more information about the <b>NUMBER(*)</b> function, see <a href="http://infocenter.sybase.com/help/topic/com.sybase.dc38151_1270/html/iqref/Number.htm" shape="rect">“NUMBER function [Miscellaneous]”</a>.</p><p>You can use the <b>ORDER BY</b> clause to control the result from an <b>UPDATE</b> when the <b>FROM</b> clause contains multiple joined tables.</p><p>Sybase IQ ignores the <b>ORDER BY </b>clause in searched <b>UPDATE</b> and returns a message that the syntax is not valid ANSI syntax.</p><p>If no <b>WHERE</b> clause is specified, every row is updated. If you specify a <b>WHERE</b> clause, Sybase IQ updates only rows satisfying the search condition.</p><p>The left side of each <b>SET</b> clause must be a column in a base table.</p><p>Views can be updated provided the <b>SELECT</b> statement defining the view does not contain a <b>GROUP BY</b> clause or an aggregate function, or involve a <b>UNION</b> operation. The view should contain only one table.</p><p>Character strings inserted into tables are always stored in the case they are entered, regardless of whether the database is case sensitive or not. Thus a character data type column updated with a string <b>Value</b> is always held in the database with an upper-case V and the remainder of the letters lowercase. <b>SELECT</b> statements return the string as <b>Value</b>. If the database is not case sensitive, however, all comparisons make <b>Value</b> the same as <b>value</b>, <b>VALUE</b>, and so on. Further, if a single-column primary key already contains an entry <b>Value</b>, an <b>INSERT</b> of <b>value</b> is rejected, as it would make the primary key not unique.</p><p>If the update violates any check constraints, the whole statement is rolled back.</p><p>Sybase IQ supports scalar subqueries within the <b>SET</b> clause, for example:</p><pre>UPDATE r<br>SETr.o= (SELECT MAX(t.o) FROM t ... WHERE t.y = r.y),r.s= (SELECT SUM(x.s) FROM x ... WHERE x.x = r.x)<br>WHERE r.a = 10<br></pre><p>Sybase IQ supports DEFAULT column values in <b>UPDATE</b> statements. If a column has a DEFAULT value, this DEFAULT value is used as the value of the column in any <b>UPDATE</b> statement that does not explicitly modify the value for the column.</p><p>For detailed information on the use of column DEFAULT values, see <a href="http://infocenter.sybase.com/help/topic/com.sybase.dc00170_1270/html/iqapg/Intdefault.htm" shape="rect" to-id="Intdefault">“Using column defaults”</a> in <a href="http://infocenter.sybase.com/help/topic/com.sybase.dc00170_1270/html/iqapg/X100769.htm" shape="rect" to-id="X100769">Chapter 9, “Ensuring Data Integrity”</a> in the <i>Sybase IQ System Administration Guide</i>.</p><p>See the <a href="http://infocenter.sybase.com/help/topic/com.sybase.dc38151_1270/html/iqref/X315712.htm" shape="rect">CREATE TABLE statement</a> for details about updating IDENTITY/AUTOINCREMENT columns, which are another type of DEFAULT column.</p><p><br clear="none">&nbsp;</p><h4>Side effects</h4><p>None.</p><h3 class="refhead">Standards</h3><ul><li class="fi"><p><b>SQL92</b> Vendor extension. </p></li><li class="ds"><p><b>Sybase</b> With the following exceptions, syntax of the IQ <b>UPDATE</b> statement is generally compatible with the Adaptive Server Enterprise <b>UPDATE</b> statement Syntax 1: Sybase IQ supports multiple tables with join conditions in the <b>FROM</b> clause.</p><p>The Transact-SQL <b>ROWCOUNT</b> option has no effect on <b>UPDATE</b> operations in Sybase IQ.</p><p>Updates of remote tables are limited to Sybase IQ syntax supported by CIS, as described in <a href="http://infocenter.sybase.com/help/topic/com.sybase.dc00170_1270/html/iqapg/X316091.htm" shape="rect" to-id="X316091">Chapter 17, “Server Classes for Remote Data Access”</a> and <a href="http://infocenter.sybase.com/help/topic/com.sybase.dc00170_1270/html/iqapg/X99999.htm" shape="rect" to-id="X99999">Chapter 16, “Accessing Remote Data”</a> in the <i>Sybase IQ System Administration Guide</i>.</p></li></ul><h3 class="refhead">Permissions</h3><p>Must have UPDATE permission for the columns being modified.</p></div><br></div>
                        <div class="post-footer">
                            <button class="btn" onclick="button_click();">목록</button>
                        </div>
                    </div>
                </article>
            </main>
        </section>

        <script src="https://code.jquery.com/jquery-3.5.1.js"></script>

        <script>
            function button_click() {
                if(history.length > 1) {
                    history.back();
                } else {
                    document.location.href = "../../블로그포스트목록.html";
                }
            }
        </script>
    </body>
</html>
