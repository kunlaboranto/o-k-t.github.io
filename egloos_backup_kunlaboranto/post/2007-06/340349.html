<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="../../css/result.css">

        <title>[펌] [HPUX] shared library in use + possible resolution ( chatr +dbg enable ..)</title>
    </head>
    <body>
        <section id="wrap">
            <header>
                <h1 class="logo-title">
                    <span class="main"><img src="../../images/logo_egloos.png" width="105" height="34" alt="이글루스"></span>
                </h1>
                <div class="user-info">
                    <strong class="name">kun</strong> 님 (<strong class="name">okseop7</strong>)
                </div>
            </header>
            <main>
                <article class="post-wrap">
                    <!-- 게시물 정보 : 날짜 -->
                    <div class="post-info">
                        <span class="time">2007-06-24 15:42:37</span>
                    </div>
                    <!-- 게시물 제목 -->
                    <h2 class="post-title">[펌] [HPUX] shared library in use + possible resolution ( chatr +dbg enable ..)</h2>
                    <!-- 게시물 본문 -->
                    <div class="post-body">
                        <div class="content">From : <a href="http://forums1.itrc.hp.com/service/forums/questionanswer.do?threadId=733325&amp;admit=-682735245+1182666859610+28353475">http://forums1.itrc.hp.com/service/forums/questionanswer.do?threadId=733325&amp;admit=-682735245+1182666859610+28353475</a><br><br><h1><span style="FONT-SIZE: 100%; FONT-FAMILY: '굴림','Gulim'">shared library in use + possible resolution - This thread has been closed</span></h1><tr class="theme"><td class="themeheader" width="18%" align="left">Author<!--startindex--> </td><td class="themeheader" width="72%" align="left">Subject: shared library in use + possible resolution &nbsp;&nbsp;&nbsp;&nbsp; <a href="http://forums1.itrc.hp.com/service/forums/setFavorites.do?forumId=1&amp;threadId=733325&amp;takeAction=addFavorites"><img alt="Add to my favorites" src="http://forums1.itrc.hp.com/service/forums/images/expressions/favorites_add.gif" border="0"></a> &nbsp;<img alt="This thread has been closed" src="http://forums1.itrc.hp.com/service/forums/images/hpcom/hpnewclosed_thread_icon.gif" border="0"> </td></tr><tr bgcolor="#dedfdf"><td id="tdIdNameQA" align="left" valign="top"><a class="udrline" href="http://forums1.itrc.hp.com/service/forums/publicProfile.do?userId=BR713419&amp;forumId=1">Peter De Peuter</a> <!--this will show the hats gif according to the user points--><br></td><!-- Added by San --><td align="left" valign="top"><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td class="SubText">Nov 4, 2004 13:08:04 GMT </td><td align="right"><!-- edit question by phani kumar K-->&nbsp;&nbsp; <!-- end delete question by Phani Kumar K--></td></tr></tbody></table><hr noShade size="1"><span class="Text"><table><tbody><tr><td id="tdIdName0">I am not used to the fact that a shared library is in use when a program runs, on linux you can rm or mv a shared library, the executable will keep on running happily, on restart of course it will use the new version (since the old is gone ;-) or not start anymore <br><br><br>I found a solution for this if I create an executable and afterward I say<br>chatr +dbg enable &lt;prog&gt;<br>I can move, replace the shared libs used by the executable while it is running.<br><br>questions<br>-is this the way to go about it and is it possible to tell aCC of ld directly what I want and avoiding the chatr step ??<br>-is there a danger involved by using chatr +dbg enable and is it really safe to remove a shared lib afterward ? (won't it be referenced ever again ?)<br><br><br>(I believe on linux it works because you can mv or rm the file, but as long as it is in use the inode stays alive, untill the last reference to the file is dropped) </td></tr></tbody></table></span></td><!--stopindex--></tr><tr><td class="TextBlueItalic" bgcolor="#ffffff" colspan="2">Note: If you are the author of this question and wish to assign points to any of the answers, please login first.For more information on assigning points ,click <a class="udrline" href="http://forums1.itrc.hp.com/service/forums/helptips.do">here</a> <!--startindex--></td></tr><tr><td align="right" bgcolor="#ffffff" colspan="2"><br><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td align="left" width="50%"><!-- render select & delete message buttons added by phanikumar --><!-- stop render select & delete message buttons added by phanikumar --></td><td align="right" width="50%"><b><!--stopindex--><br>Sort Answers By: <span class="pageIndicator">Date</span> or <a class="udrline" href="http://forums1.itrc.hp.com/service/forums/questionanswer.do?threadId=733325&amp;sortPointsFlag=1">Points</a><br></b></td></tr></tbody></table></td></tr><tr bgcolor="#e7e7e7"><td align="left" valign="top"><!-- beging rendering checkbox --><!-- end rendering checkbox --><!--startindex--><a class="udrline" href="http://forums1.itrc.hp.com/service/forums/publicProfile.do?userId=CA945075&amp;forumId=1">ranganath ramachandra</a> <img alt="This member has accumulated 500 or more points" src="http://forums1.itrc.hp.com/service/forums/images/expressions/mortarboard.gif" align="absBottom" border="0"> </td><!-- Added by San Need to Check. Required --><td align="left" valign="top"><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td class="SubText" valign="bottom">Nov 4, 2004 15:04:38 GMT&nbsp; <!--add code here-->8&nbsp;pts </td><td align="right"><!-- ADMIN/MODERATOR EDIT ANSWER --><!-- END ADMIN/MODERATOR EDIT ANSWER --><!--this should be a notEqual tag,change it once you have attachements in the database ashish june10,2003--></td></tr></tbody></table><hr noShade size="1"><span class="Text"><table><tbody><tr><td id="tdIdName1">i dont know exactly why this is so but:<br><br>a shared library is supposed to be shared in memory by all processes that simultaneously load it. when you do a chatr +dbg enable, the library is mapped private into the memory of each process that loads it.<br><br>btw, 'mv -f' should work on the busy text file too.<!--stopindex--></td></tr></tbody></table></span></td></tr><tr bgcolor="#ffffff"><td align="left" valign="top"><!-- beging rendering checkbox --><!-- end rendering checkbox --><!--startindex--><a class="udrline" href="http://forums1.itrc.hp.com/service/forums/publicProfile.do?userId=BR809875&amp;forumId=1">Peter</a> </td><!-- Added by San Need to Check. Required --><td align="left" valign="top"><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td class="SubText" valign="bottom">Nov 4, 2004 15:10:59 GMT&nbsp; <!--add code here-->&nbsp;&nbsp;Unassigned </td><td align="right"><!-- ADMIN/MODERATOR EDIT ANSWER --><!-- END ADMIN/MODERATOR EDIT ANSWER --><!--this should be a notEqual tag,change it once you have attachements in the database ashish june10,2003--></td></tr></tbody></table><hr noShade size="1"><span class="Text"><table><tbody><tr><td id="tdIdName2">mv -f, rm -f doesn't work<br>mv: libhello.sl: cannot write: Text file busy<br><br>remains the question -&gt; is there an option which I can pass to aCC avoiding the chatr step (because an extra step is error prone, and will be forgotten)<br><br>and is it absolutely safe (so is _everything_ mapped in memory)<br><br>why ?<br>whe wrote a shared lib used by lots of deamon processes, which every once in while needs to be updated, but we don't want to restart all the deamons, ..<br><br>cheers,<br><br>Peter<!--stopindex--></td></tr></tbody></table></span></td></tr><tr bgcolor="#e7e7e7"><td align="left" valign="top"><!-- beging rendering checkbox --><!-- end rendering checkbox --><!--startindex--><a class="udrline" href="http://forums1.itrc.hp.com/service/forums/publicProfile.do?userId=CA843897&amp;forumId=1">Ermin Borovac</a> <img alt="This member has accumulated 2500 or more points" src="http://forums1.itrc.hp.com/service/forums/images/expressions/crown.gif" align="absBottom" border="0"> </td><!-- Added by San Need to Check. Required --><td align="left" valign="top"><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td class="SubText" valign="bottom">Nov 5, 2004 02:11:32 GMT&nbsp; <!--add code here-->9&nbsp;pts </td><td align="right"><!-- ADMIN/MODERATOR EDIT ANSWER --><!-- END ADMIN/MODERATOR EDIT ANSWER --><!--this should be a notEqual tag,change it once you have attachements in the database ashish june10,2003--></td></tr></tbody></table><hr noShade size="1"><span class="Text"><table><tbody><tr><td id="tdIdName3">You can try using cpset with -o option. This should move object (shared library) that's in use to OLDobject and install a new one instead.<br><br># /usr/bin/cpset -o new_shared_lib directory_to_install_to<br><br>This should rename old shared library to OLD&lt;file&gt;. Running daemons should continue using old shared library until they are restarted.<!--stopindex--></td></tr></tbody></table></span></td></tr><tr bgcolor="#ffffff"><td align="left" valign="top"><!-- beging rendering checkbox --><!-- end rendering checkbox --><!--startindex--><a class="udrline" href="http://forums1.itrc.hp.com/service/forums/publicProfile.do?userId=BR713419&amp;forumId=1">Peter De Peuter</a> </td><!-- Added by San Need to Check. Required --><td align="left" valign="top"><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td class="SubText" valign="bottom">Nov 5, 2004 09:39:12 GMT&nbsp; <!--add code here-->&nbsp; N/A: Question Author </td><td align="right"><!-- ADMIN/MODERATOR EDIT ANSWER --><!-- END ADMIN/MODERATOR EDIT ANSWER --><!--this should be a notEqual tag,change it once you have attachements in the database ashish june10,2003--></td></tr></tbody></table><hr noShade size="1"><span class="Text"><table><tbody><tr><td id="tdIdName4">well well cpset !<br><br>never heard of it, it has one problem though, I can use it only once, because it will rename the lib to OLDlib, and the second time OLDlib is in use by the daemons, and cpset refuses duty.<br><br>BUT it rang a bell, and I found a nice solution (wouldn't have thought of it without cpset though !)<br>&lt;file move.c&gt;<br>/*just demo proof of concept code, bla, bla*/<br>#include &lt;unistd.h&gt;<br>#include &lt;string.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;errno.h&gt;<br><br>int main(int argc,char *argv[])<br>{<br>if ( link(argv[1],argv[2] ) )<br>{<br>printf("error : copy %s -&gt; %s : %s\n",argv[1],argv[2],strerror(errno) ) ;<br>}<br>else<br>{<br>if ( unlink(argv[1]) )<br>{<br>printf("error : remove %s : %s\n",argv[1],strerror(errno) ) ;<br>}<br>}<br>}<br>&lt;end file move.c&gt;<br><br>aCC move.c -o move<br><br>move &lt;file_maybe_inuse_maybenot&gt; &lt;newfile&gt;<br><br>and YES, it works, all the time, ... !<br><br>any dangers involved guru's ?<br><br><br>cheers, Peter<!--stopindex--></td></tr></tbody></table></span></td></tr><tr bgcolor="#e7e7e7"><td align="left" valign="top"><!-- beging rendering checkbox --><!-- end rendering checkbox --><!--startindex--><a class="udrline" href="http://forums1.itrc.hp.com/service/forums/publicProfile.do?userId=CA843897&amp;forumId=1">Ermin Borovac</a> <img alt="This member has accumulated 2500 or more points" src="http://forums1.itrc.hp.com/service/forums/images/expressions/crown.gif" align="absBottom" border="0"> </td><!-- Added by San Need to Check. Required --><td align="left" valign="top"><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td class="SubText" valign="bottom">Nov 7, 2004 23:49:22 GMT&nbsp; <!--add code here-->10&nbsp;pts </td><td align="right"><!-- ADMIN/MODERATOR EDIT ANSWER --><!-- END ADMIN/MODERATOR EDIT ANSWER --><!--this should be a notEqual tag,change it once you have attachements in the database ashish june10,2003--></td></tr></tbody></table><hr noShade size="1"><span class="Text"><table><tbody><tr><td id="tdIdName5">Your code is similar to what cpset does (as far as I can see with tusc).<br><br>Please note that 'mv -f' will also work, but you have to do it as follows.<br><br># mv -f libhello.sl \#libhello.sl<br># cp newlibhello.sl libhello.sl<br><br>It won't work if you do it as<br><br># mv -f newlibhello.sl libhello.sl<!--stopindex--></td></tr></tbody></table></span></td></tr><tr bgcolor="#ffffff"><td align="left" valign="top"><!-- beging rendering checkbox --><!-- end rendering checkbox --><!--startindex--><a class="udrline" href="http://forums1.itrc.hp.com/service/forums/publicProfile.do?userId=BR713419&amp;forumId=1">Peter De Peuter</a> </td><!-- Added by San Need to Check. Required --><td align="left" valign="top"><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td class="SubText" valign="bottom">Nov 8, 2004 07:57:04 GMT&nbsp; <!--add code here-->&nbsp; N/A: Question Author </td><td align="right"><!-- ADMIN/MODERATOR EDIT ANSWER --><!-- END ADMIN/MODERATOR EDIT ANSWER --><!--this should be a notEqual tag,change it once you have attachements in the database ashish june10,2003--></td></tr></tbody></table><hr noShade size="1"><span class="Text"><table><tbody><tr><td id="tdIdName6">Aha, first move it out of the way,...<br><br>why didn't I think of that <br><br>great answers guys, thanks, <br><br>I need what I want, <br><br>greetz,<br><br>Peter<!--stopindex--></td></tr></tbody></table></span></td></tr><tr bgcolor="#e7e7e7"><td align="left" valign="top"><!-- beging rendering checkbox --><!-- end rendering checkbox --><!--startindex--><a class="udrline" href="http://forums1.itrc.hp.com/service/forums/publicProfile.do?userId=BR713419&amp;forumId=1">Peter De Peuter</a> </td><!-- Added by San Need to Check. Required --><td align="left" valign="top"><table cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td class="SubText" valign="bottom">Nov 8, 2004 07:58:37 GMT&nbsp; <!--add code here-->&nbsp;<span style="COLOR: #ff9900"><b>Thread closed by author</b></span> &nbsp;</td></tr></tbody></table></td></tr></div>
                        <div class="post-footer">
                            <button class="btn" onclick="button_click();">목록</button>
                        </div>
                    </div>
                </article>
            </main>
        </section>

        <script src="https://code.jquery.com/jquery-3.5.1.js"></script>

        <script>
            function button_click() {
                if(history.length > 1) {
                    history.back();
                } else {
                    document.location.href = "../../블로그포스트목록.html";
                }
            }
        </script>
    </body>
</html>
